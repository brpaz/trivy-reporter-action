# Trivy Reporter Action

> A GitHub Action to manage [Trivy](https://trivy.dev/) security reports using GitHub Issues.

## Features

- Parses Trivy JSON output to extract vulnerability information.
- Creates or updates a GitHub Issue with the security report.
- Supports custom issue titles and labels.
- Automatically closes old issues when no vulnerabilities are found.

To check an example of the generated report, see [this issue](https://github.com/brpaz/trivy-reporter-action/issues/1).

## Getting Started

This GitHub Action reads the JSON output from a Trivy vulnerability scan and creates or updates a GitHub Issue with the security report. It helps you keep track of vulnerabilities found in your projects directly within GitHub.

### Usage

To use this action, include it after running the Trivy vulnerability scanner in your GitHub Actions workflow. Below is an example workflow configuration:

```yaml
name: 'Test'
on:
  push:
    branches:
      - main
jobs:
  trivy-scan:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v5

      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@0.28.0
        with:
          image-ref: 'docker.io/my-organization/my-app:${{ github.sha }}'
          format: 'json'
          output: 'trivy-results.json'

      - name: Generate Trivy report
        uses: brpaz/trivy-reporter-action@main
        if: ${{ !cancelled() }}
        with:
          report-path: 'trivy-results.json'
          issue-title: 'Security Report - Trivy Vulnerability Scan'
          github-token: ${{ secrets.GITHUB_TOKEN }}
          labels: 'security,trivy'
```

### Inputs

This action accepts the following inputs:

| Input Name     | Description                                              | Required | Default Value                 |
| -------------- | -------------------------------------------------------- | -------- | ----------------------------- |
| `report-path`  | The path to the json file generated by Trivy             | false    | 'trivy-report.json'           |
| `issue-title`  | The title of the GitHub Issue to create or update        | false    | 'Trivy Security Report'       |
| `github-token` | GitHub token with permissions to create or update issues | false    | `${{ secrets.GITHUB_TOKEN }}` |
| `labels`       | Comma-separated list of labels to apply to the issue     | false    | ''                            |

## Contributing

All contributions are welcome!

Please read the [CONTRIBUTING.md](CONTRIBUTING.md) file for details on how to contribute.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
